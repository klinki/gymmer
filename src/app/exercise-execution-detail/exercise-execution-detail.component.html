<div class="page-content">
  <!-- Header -->
  <div class="header-container">
    <button mat-icon-button class="back-button" (click)="back()">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h2>{{exercise?.name}}</h2>
  </div>

  @if (!loading()) {
    @if (exercise != null) {
      <!-- List of completed sets -->
      <div class="series-list">
        @for (element of exercise.series; track element; let i = $index) {
          <div class="series-card">
            <div class="series-info">
              <div class="series-index">{{i + 1}}</div>
              <div class="series-data">
                <div>
                  <span>{{element.weight}}</span> <span class="unit">kg</span>
                </div>
                <div>
                  <span>{{element.repetitions}}</span> <span class="unit">reps</span>
                </div>
              </div>
            </div>
            <button mat-icon-button color="warn" (click)="deleteSeries(element)">
              <mat-icon>delete_outline</mat-icon>
            </button>
          </div>
        }

        @if (exercise.series.length === 0) {
           <div style="text-align: center; padding: 32px; opacity: 0.6">
             <p>No sets recorded yet.</p>
           </div>
        }
      </div>
    }
  }

  <!-- Bottom Input Sheet -->
  <div class="input-area">
    <div class="input-grid">
      <!-- Weight Control -->
      <div class="control-group">
        <label>Weight (kg)</label>
        <div class="adjust-buttons">
           <button mat-icon-button (click)="currentValue.weight = (currentValue.weight ?? 0) - 1">
              <mat-icon>remove</mat-icon>
           </button>
           <div class="value-display">{{currentValue.weight}}</div>
           <button mat-icon-button (click)="currentValue.weight = (currentValue.weight ?? 0) + 1">
              <mat-icon>add</mat-icon>
           </button>
        </div>
      </div>

      <!-- Reps Control -->
      <div class="control-group">
        <label>Reps</label>
        <div class="adjust-buttons">
           <button mat-icon-button (click)="currentValue.repetitions = (currentValue.repetitions ?? 0) - 1">
              <mat-icon>remove</mat-icon>
           </button>
           <div class="value-display">{{currentValue.repetitions}}</div>
           <button mat-icon-button (click)="currentValue.repetitions = (currentValue.repetitions ?? 0) + 1">
              <mat-icon>add</mat-icon>
           </button>
        </div>
      </div>
    </div>

    <mat-form-field appearance="outline" class="note-field">
       <mat-label>Notes</mat-label>
       <input matInput [(ngModel)]="currentValue.note" placeholder="Optional notes...">
    </mat-form-field>

    <div class="action-buttons">
       <button mat-flat-button color="primary" (click)="add()">
          <mat-icon>check</mat-icon>
          LOG SET
       </button>
    </div>
  </div>
</div>
